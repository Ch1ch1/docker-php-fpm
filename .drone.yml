---
kind: pipeline
type: docker
name: Building..
node:
  drone: ch1
steps:
  - name: build & push php8
    image: plugins/docker
    settings:
      repo: ch1ch1/php-fpm
      tags: [ "8.1.6-debian", "latest" ]
      username: ch1ch1
      password:
        from_secret: dockerhub_token
  - name: build & push php7
    image: plugins/docker
    settings:
      repo: ch1ch1/php-fpm
      tags: [ "7.4.29-debian" ]
      username: ch1ch1
      dockerfile: Dockerfilephp7
      password:
        from_secret: dockerhub_token
  - name: notification
    image: plugins/webhook
    settings:
      urls:
        from_secret: webhookgotify
      content_type: application/json
      template: |
        {
         "message": "{{ repo.owner }} as updated {{ repo.name }} with {{ build.status }}.",
         "priority": 4,
         "title": "{{ repo.name }} build"
        }
    when:
      status: [success, failure]

trigger:
  event:
    - push
---
kind: signature
hmac: 85f74816a5a2f4676f5867e46b2155ccc2541441d9a853c42d5ccd9d544922f4

...
